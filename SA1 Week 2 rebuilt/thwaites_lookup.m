function H = thwaites_lookup(m)
    % if m <= -0.25     % outside range of table, return values at -0.25
    %     H = 2;
    % 
    % elseif m <= 0.09    % interpolate from tabulated values
    %     mtab = [-.25 -.2 -.14 -.12 -.1 -.08 -.064 -.048 -.032 -.016 .0 .016 .032 ...
    %          .04 .048 .056 .06 .064 .068 .072 .076 .080 .084 .086 .088 .09];
    % 
    %     Htab = [2 2.07 2.18 2.23 2.28 2.34 2.39 2.44 2.49 2.55 2.61 2.67 2.75 ...
    %        2.81 2.87 2.94 2.99 3.04 3.09 3.15 3.22 3.3 3.39 3.44 3.49 3.55];
    % 
    %     H = interp1(mtab,Htab,m);
    % 
    % else      %  m > 0.09; b-l separated
    %     H = 3.55;
    % 
    % end

    mtab = [-.25 -.2 -.14 -.12 -.1 -.08 -.064 -.048 -.032 -.016 .0 .016 .032 ...
    .04 .048 .056 .06 .064 .068 .072 .076 .080 .084 .086 .088 .09];
        
    Htab = [2 2.07 2.18 2.23 2.28 2.34 2.39 2.44 2.49 2.55 2.61 2.67 2.75 ...
    2.81 2.87 2.94 2.99 3.04 3.09 3.15 3.22 3.3 3.39 3.44 3.49 3.55];

    M = [m];
    a = (M <= -0.25);
    b = (-0.25 < M) .* (M <= 0.09);
    c = 1-a-b;

    T1 = 2*a;
    T2 = interp1(mtab, Htab, b.*M) .* b;
    T3 = 3.55*c;

    H = T1 + T2 +T3;
end
